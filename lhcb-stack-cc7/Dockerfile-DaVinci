# vim:set ft=dockerfile:

ARG DAVINCI_VERSION=v44r8
ARG GCC_DEPENDENCY=x86_64_centos7_gcc7_opt

FROM umdlhcb/centos7-base:latest

ARG DAVINCI_VERSION
ARG GCC_DEPENDENCY

# Install DaVinci
RUN mkdir -p /tmp/lbinstall-tmp && \
    mkdir -p /tmp/lbinstall-cache
RUN . /opt/lhcb/LbLogin.sh && \
    lbinstall --root=/opt/lhcb --tmp_dir=/tmp/lbinstall-tmp --rpmcache=/tmp/lbinstall-cache \
        install DAVINCI_${DAVINCI_VERSION}_${GCC_DEPENDENCY}

# Cleanups
RUN rm -rf /tmp/*
